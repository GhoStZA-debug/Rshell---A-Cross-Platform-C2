import{_ as _e}from"./f5f6aa45.js";/* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        */import"./4ed993c7.js";/* empty css        *//* empty css        *//* empty css        */import{a as d,b as q,v as ue,z as me,ai as fe,x as he,J as ve,y as ge,f as ye,h as ke,i as we,K as be,am as Se,an as Ce,N as Ee,O as Ve,ao as xe,ap as Ue,P as ze,w as Pe,L as Ne,M as Te,aq as De,D as $e}from"./3325456c.js";import{C as S}from"./59206fab.js";import{H as Ie,aB as Be,r as v,_ as Re,e as $,d as qe,l as p,m,V as o,P as t,p as e,T as c,u as Me,O as U,U as _,S as z,J as Fe,az as He,aA as Le}from"./95bbca75.js";const n=C=>(He("data-v-3ce5ea16"),C=C(),Le(),C),Oe={class:"socks5-container"},Ae={class:"header-content"},Ge=n(()=>e("div",{class:"header-left"},[e("h2",{class:"header-title"},[e("i",{class:"el-icon-connection header-icon"}),c(" Socks5代理管理 ")]),e("p",{class:"header-description"}," 管理主机上的Socks5代理服务，实现网络流量转发 ")],-1)),Je={class:"header-right"},Ke=n(()=>e("i",{class:"el-icon-plus"},null,-1)),je={class:"table-header"},Qe=n(()=>e("div",{class:"table-title"},[e("i",{class:"el-icon-s-order"}),e("span",null,"代理列表")],-1)),We={class:"table-actions"},Xe=n(()=>e("i",{class:"el-icon-question"},null,-1)),Ye={key:1},Ze={class:"port-cell"},es={class:"port-number"},ss={key:0,class:"auth-info"},ts=n(()=>e("i",{class:"el-icon-user"},null,-1)),os={key:1,class:"no-auth"},as={key:0,class:"password-cell"},ls=n(()=>e("span",{class:"password-mask"},"••••••",-1)),ns=n(()=>e("i",{class:"el-icon-view"},null,-1)),cs={key:1,class:"no-auth"},is={class:"connection-info"},rs={class:"connection-item"},ds=n(()=>e("span",{class:"label"},"类型：",-1)),ps={class:"connection-item"},_s=n(()=>e("span",{class:"label"},"状态：",-1)),us={class:"action-buttons"},ms=n(()=>e("i",{class:"el-icon-video-play"},null,-1)),fs=n(()=>e("i",{class:"el-icon-video-pause"},null,-1)),hs=n(()=>e("i",{class:"el-icon-delete"},null,-1)),vs=n(()=>e("i",{class:"el-icon-more"},null,-1)),gs=n(()=>e("i",{class:"el-icon-document-copy"},null,-1)),ys=n(()=>e("i",{class:"el-icon-connection"},null,-1)),ks={key:0,class:"stats-info"},ws={class:"stat-item"},bs=n(()=>e("span",{class:"stat-label"},"总数：",-1)),Ss={class:"stat-value"},Cs={class:"stat-item"},Es=n(()=>e("span",{class:"stat-label"},"运行中：",-1)),Vs={class:"stat-value running"},xs={class:"stat-item"},Us=n(()=>e("span",{class:"stat-label"},"已停止：",-1)),zs={class:"stat-value stopped"},Ps=n(()=>e("span",{class:"input-prepend"},"端口",-1)),Ns=n(()=>e("div",{class:"form-tip"}," 建议使用 10000-65535 之间的端口 ",-1)),Ts=n(()=>e("span",{class:"input-prepend"},"用户",-1)),Ds=n(()=>e("span",{class:"input-prepend"},"密码",-1)),$s=n(()=>e("div",{class:"form-tip"}," 若设置用户名，则必须同时设置密码 ",-1)),Is={class:"dialog-footer"},Bs={class:"help-content"},Rs=n(()=>e("h3",null,[e("i",{class:"el-icon-info"}),c(" 什么是Socks5代理？")],-1)),qs=n(()=>e("p",null,"Socks5是一种网络代理协议，它比HTTP代理更底层，可以代理各种类型的网络流量。",-1)),Ms=n(()=>e("h3",null,[e("i",{class:"el-icon-setting"}),c(" 使用方法")],-1)),Fs=n(()=>e("p",null,'点击"新增代理"按钮，配置端口和认证信息',-1)),Hs=n(()=>e("p",null,'创建后，点击"开启"按钮启动代理服务',-1)),Ls=n(()=>e("p",null,"在客户端工具中配置代理地址：",-1)),Os={class:"config-example"},As=n(()=>e("p",null,"配置完成后，所有流量将通过代理服务器转发",-1)),Gs=n(()=>e("h3",null,[e("i",{class:"el-icon-warning-outline"}),c(" 注意事项")],-1)),Js=n(()=>e("ul",{class:"notice-list"},[e("li",null,"确保防火墙已开放对应端口"),e("li",null,"建议使用高强度密码"),e("li",null,"定期检查代理状态和日志"),e("li",null,"不使用时请及时关闭代理")],-1)),Ks=Ie({__name:"ClientSocks5",setup(C){const g=Be().query.uid,f=v(!1),E=v(!1),y=v(!1),P=v(!1),u=v([]),k=v(),i=Re({connectAddress:"",socks5port:"",username:"",password:"",type:"socks5"}),M={socks5port:[{required:!0,message:"请输入端口号",trigger:"blur"},{pattern:/^[1-9]\d*$/,message:"端口号必须为正整数",trigger:"blur"},{validator:(a,s,r)=>{s&&(parseInt(s)<1||parseInt(s)>65535)?r(new Error("端口号范围 1-65535")):r()},trigger:"blur"}],username:[{validator:(a,s,r)=>{s&&!i.password?r(new Error("设置了用户名必须同时设置密码")):!s&&i.password?r(new Error("设置了密码必须同时设置用户名")):r()},trigger:"blur"}]},F=$(()=>u.value.filter(a=>a.Status===1).length),H=$(()=>u.value.filter(a=>a.Status===2).length),I=$(()=>window.location.hostname||"localhost"),h=async()=>{y.value=!0;try{const a=await S.getSocks5List({uid:g});a.status===200&&a.data.data&&(u.value=a.data.data.map(s=>({...s,loading:!1,deleting:!1})))}catch(a){console.error("获取代理列表失败:",a),d.error("获取代理列表失败")}finally{y.value=!1}},L=async()=>{await h(),d.success("列表已刷新")},O=async()=>{k.value&&await k.value.validate(async a=>{if(a){P.value=!0;try{const s=await S.startSocks5({Password:i.password,Socks5port:i.socks5port,UserName:i.username,uid:g});s.status===200&&(s.data.status===200?(d.success("代理创建成功"),f.value=!1,await h()):d.error(s.data.data||"创建失败"))}catch(s){console.error("创建代理失败:",s),d.error("创建代理失败")}finally{P.value=!1}}})},A=async a=>{a.loading=!0;try{const s=await S.CloseSocks5({Password:a.Password,Socks5port:a.Socks5port,UserName:a.UserName,uid:g});s.status===200&&(s.data.status===200?(d.success("代理已停止"),await h()):d.error(s.data.data||"停止失败"))}catch(s){console.error("停止代理失败:",s),d.error("停止代理失败")}finally{a.loading=!1}},G=async a=>{a.loading=!0;try{const s=await S.OpenSocks5({Password:a.Password,Socks5port:a.Socks5port,UserName:a.UserName,uid:g});s.status===200&&(s.data.status===200?(d.success("代理已开启"),await h()):d.error(s.data.data||"开启失败"))}catch(s){console.error("开启代理失败:",s),d.error("开启代理失败")}finally{a.loading=!1}},J=async a=>{try{await q.confirm("确定要删除此代理吗？删除后无法恢复。","确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),a.deleting=!0;const s=await S.DeleteSocks5({Password:a.Password,Socks5port:a.Socks5port,UserName:a.UserName,uid:g});s.status===200&&(s.data.status===200?(d.success("代理已删除"),await h()):d.error(s.data.data||"删除失败"))}catch(s){s!=="cancel"&&(console.error("删除代理失败:",s),d.error("删除代理失败"))}finally{a.deleting=!1}},K=(a,s)=>{switch(a){case"copy":j(s);break;case"test":Q();break}},j=a=>{const s=`Socks5代理配置：
服务器: ${I.value}
端口: ${a.Socks5port}
用户名: ${a.UserName||"无"}
密码: ${a.Password||"无"}`;navigator.clipboard.writeText(s).then(()=>{d.success("连接信息已复制到剪贴板")}).catch(()=>{d.error("复制失败")})},Q=async a=>{d.info("测试连接功能开发中...")},W=a=>{q.alert(`密码：${a.Password}`,"密码详情",{confirmButtonText:"确定",callback:()=>{X(a.Password)}})},X=a=>{navigator.clipboard.writeText(a).then(()=>{d.success("密码已复制到剪贴板")})},Y=()=>{k.value&&k.value.resetFields(),i.socks5port="",i.username="",i.password="",i.type="socks5"},Z=()=>{E.value=!E.value};return qe(async()=>{await h()}),(a,s)=>{const r=ue,N=me,ee=fe,T=he,w=ve,se=ge,B=ye,te=ke,oe=we,ae=be,R=Se,le=Ce,D=Ee,V=Ve,ne=xe,ce=Ue,ie=ze,re=Pe,x=Ne,de=Te,pe=De;return p(),m("div",Oe,[o(N,{shadow:"never",class:"header-card"},{default:t(()=>[e("div",Ae,[Ge,e("div",Je,[o(r,{type:"primary",size:"large",onClick:s[0]||(s[0]=l=>f.value=!0),class:"add-button"},{default:t(()=>[Ke,c(" 新增代理 ")]),_:1})])])]),_:1}),o(N,{shadow:"never",class:"table-card"},{header:t(()=>[e("div",je,[Qe,e("div",We,[o(r,{type:"info",size:"small",icon:Me($e),onClick:L,loading:y.value},{default:t(()=>[c(" 刷新 ")]),_:1},8,["icon","loading"]),o(r,{type:"text",size:"small",onClick:Z},{default:t(()=>[Xe,c(" 使用说明 ")]),_:1})])])]),default:t(()=>[u.value.length===0&&!y.value?(p(),U(ee,{key:0,description:"暂无代理配置","image-size":100},{default:t(()=>[o(r,{type:"primary",onClick:s[1]||(s[1]=l=>f.value=!0)},{default:t(()=>[c(" 创建第一个代理 ")]),_:1})]),_:1})):(p(),m("div",Ye,[o(ae,{data:u.value,loading:y.value,style:{width:"100%"},class:"proxy-table",stripe:""},{default:t(()=>[o(w,{prop:"Socks5port",label:"端口",width:"120"},{default:t(({row:l})=>[e("div",Ze,[e("span",es,_(l.Socks5port),1),l.Status===1?(p(),U(T,{key:0,size:"small",type:"info",effect:"plain"},{default:t(()=>[c(" 已开启 ")]),_:1})):z("",!0)])]),_:1}),o(w,{prop:"UserName",label:"用户名",width:"150"},{default:t(({row:l})=>[l.UserName?(p(),m("span",ss,[ts,c(" "+_(l.UserName),1)])):(p(),m("span",os,"无认证"))]),_:1}),o(w,{prop:"Password",label:"密码",width:"180"},{default:t(({row:l})=>[l.Password?(p(),m("div",as,[ls,o(se,{content:"点击显示密码",placement:"top"},{default:t(()=>[o(r,{type:"text",size:"small",onClick:b=>W(l),class:"show-password-btn"},{default:t(()=>[ns]),_:2},1032,["onClick"])]),_:2},1024)])):(p(),m("span",cs,"无密码"))]),_:1}),o(w,{label:"连接信息","min-width":"200"},{default:t(({row:l})=>[e("div",is,[e("div",rs,[ds,o(T,{size:"small"},{default:t(()=>[c(_(l.Type),1)]),_:2},1024)]),e("div",ps,[_s,o(T,{type:l.Status===1?"success":"danger",size:"small",effect:l.Status===1?"light":"plain"},{default:t(()=>[e("i",{class:Fe(l.Status===1?"el-icon-success":"el-icon-error")},null,2),c(" "+_(l.Status===1?"运行中":"已停止"),1)]),_:2},1032,["type","effect"])])])]),_:1}),o(w,{label:"操作",width:"240",align:"center",fixed:"right"},{default:t(({row:l})=>[e("div",us,[l.Status===2?(p(),U(r,{key:0,type:"success",size:"small",onClick:b=>G(l),loading:l.loading,class:"action-btn"},{default:t(()=>[ms,c(" 开启 ")]),_:2},1032,["onClick","loading"])):z("",!0),l.Status===1?(p(),U(r,{key:1,type:"warning",size:"small",onClick:b=>A(l),loading:l.loading,class:"action-btn"},{default:t(()=>[fs,c(" 停止 ")]),_:2},1032,["onClick","loading"])):z("",!0),o(r,{type:"danger",size:"small",onClick:b=>J(l),loading:l.deleting,class:"action-btn"},{default:t(()=>[hs,c(" 删除 ")]),_:2},1032,["onClick","loading"]),o(oe,{trigger:"click",onCommand:b=>K(b,l),size:"small"},{dropdown:t(()=>[o(te,null,{default:t(()=>[o(B,{command:"copy"},{default:t(()=>[gs,c(" 复制连接信息 ")]),_:1}),o(B,{command:"test"},{default:t(()=>[ys,c(" 测试连接 ")]),_:1})]),_:1})]),default:t(()=>[o(r,{type:"text",size:"small",class:"more-btn"},{default:t(()=>[vs]),_:1})]),_:2},1032,["onCommand"])])]),_:1})]),_:1},8,["data","loading"]),u.value.length>0?(p(),m("div",ks,[o(le,null,{default:t(()=>[e("span",ws,[bs,e("span",Ss,_(u.value.length),1)]),o(R,{direction:"vertical"}),e("span",Cs,[Es,e("span",Vs,_(F.value),1)]),o(R,{direction:"vertical"}),e("span",xs,[Us,e("span",zs,_(H.value),1)])]),_:1})])):z("",!0)]))]),_:1}),o(re,{modelValue:f.value,"onUpdate:modelValue":s[7]||(s[7]=l=>f.value=l),title:"新增Socks5代理",width:"480px",class:"add-dialog",onClose:Y},{footer:t(()=>[e("div",Is,[o(r,{onClick:s[6]||(s[6]=l=>f.value=!1)},{default:t(()=>[c("取消")]),_:1}),o(r,{type:"primary",onClick:O,loading:P.value},{default:t(()=>[c(" 确认创建 ")]),_:1},8,["loading"])])]),default:t(()=>[o(ie,{model:i,"label-width":"120px",rules:M,ref_key:"formRef",ref:k},{default:t(()=>[o(V,{label:"监听端口",prop:"socks5port",required:""},{default:t(()=>[o(D,{modelValue:i.socks5port,"onUpdate:modelValue":s[2]||(s[2]=l=>i.socks5port=l),placeholder:"请输入端口号（如：1080）",clearable:""},{prepend:t(()=>[Ps]),_:1},8,["modelValue"]),Ns]),_:1}),o(V,{label:"用户名",prop:"username"},{default:t(()=>[o(D,{modelValue:i.username,"onUpdate:modelValue":s[3]||(s[3]=l=>i.username=l),placeholder:"可选，留空则不启用认证",clearable:""},{prepend:t(()=>[Ts]),_:1},8,["modelValue"])]),_:1}),o(V,{label:"密码",prop:"password"},{default:t(()=>[o(D,{modelValue:i.password,"onUpdate:modelValue":s[4]||(s[4]=l=>i.password=l),placeholder:"可选，留空则不启用认证",type:"password","show-password":"",clearable:""},{prepend:t(()=>[Ds]),_:1},8,["modelValue"]),$s]),_:1}),o(V,{label:"代理类型",prop:"type"},{default:t(()=>[o(ce,{modelValue:i.type,"onUpdate:modelValue":s[5]||(s[5]=l=>i.type=l)},{default:t(()=>[o(ne,{label:"socks5"},{default:t(()=>[c("Socks5")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),o(pe,{modelValue:E.value,"onUpdate:modelValue":s[8]||(s[8]=l=>E.value=l),title:"使用说明",size:"400px"},{default:t(()=>[e("div",Bs,[Rs,qs,Ms,o(de,{direction:"vertical",active:4},{default:t(()=>[o(x,{title:"创建代理"},{description:t(()=>[Fs]),_:1}),o(x,{title:"启动代理"},{description:t(()=>[Hs]),_:1}),o(x,{title:"配置客户端"},{description:t(()=>[Ls,o(N,{shadow:"never",class:"example-card"},{default:t(()=>[e("pre",Os,"地址: "+_(I.value)+`
端口: [您的端口]
认证: [用户名/密码]（如已设置）`,1)]),_:1})]),_:1}),o(x,{title:"使用代理"},{description:t(()=>[As]),_:1})]),_:1}),Gs,Js])]),_:1},8,["modelValue"])])}}});const pt=_e(Ks,[["__scopeId","data-v-3ce5ea16"]]);export{pt as default};
