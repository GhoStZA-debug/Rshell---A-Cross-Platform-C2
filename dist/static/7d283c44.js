import{_ as se}from"./f5f6aa45.js";/* empty css        */import"./4ed993c7.js";/* empty css        *//* empty css        */import{a as m,b as T,d as ae,v as le,w as ne,x as ie,e as ce,y as re,z as de,A as ue,B as pe,C as _e,s as fe,D as me,F as he,o as ge,G as ve,H as Ce,I as be}from"./3325456c.js";import{T as we}from"./56879b4f.js";import{H as ye,aB as Se,ay as ke,r as v,w as ze,d as xe,Z as Ne,_ as Te,$ as Ae,A as Pe,l as C,m as S,V as s,P as o,p as l,u as n,T as c,F as Ve,a8 as Oe,K as O,S as Ee,U as u,O as Ie,J as E,az as Be,aA as Ue}from"./95bbca75.js";import{C as b}from"./59206fab.js";/* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        */const I=w=>(Be("data-v-64d9d316"),w=w(),Ue(),w),Fe={class:"client-management"},$e={class:"action-buttons"},qe={class:"color-picker-container"},De=I(()=>l("p",{class:"color-picker-hint"},"请选择标记颜色：",-1)),Me={class:"color-options"},Re=["onClick"],He={class:"color-hex"},Le={class:"dialog-footer"},je={class:"table-container"},Ge={class:"table-header"},Je=I(()=>l("h3",{class:"table-title"},"客户端管理",-1)),Ke={class:"table-header-actions"},Ze={class:"first-start-cell"},Qe={class:"timestamp"},We={class:"ip-cell"},Xe={class:"ip-text"},Ye={class:"user-cell"},et={class:"username"},tt={class:"computer-cell"},ot={class:"computer-name"},st={class:"address-cell"},at={class:"note-cell"},lt={class:"note-text"},nt={key:1,class:"note-empty"},it={class:"sleep-cell"},ct={class:"sleep-value"},rt={class:"status-cell"},dt={class:"action-cell"},ut=ye({__name:"ClientsView",setup(w){const h=Se(),k=ke(),B=v(),p=v(!1),g=v(!1),_=v(""),U=["#f31616","#09e609","#0b0be6","#e8e807","#e10fe1","#12dada"];let f="";const F=e=>{if(!e)return"-";try{return new Date(e).toLocaleString()}catch{return e}},$=e=>e?e.charAt(0).toUpperCase():"?",q=(e,a=15)=>e?e.length>a?e.substring(0,a)+"...":e:"",D=()=>{_.value=""},M=()=>{_.value="",g.value=!1},R=async()=>{_.value&&(await b.select_color({uid:f,color:_.value})).data.status===200&&m.success("标记颜色成功"),g.value=!1,p.value=!1},z=v([]),r={page:Number(h.query.page)||1,pageSize:Number(h.query.pageSize)||10},A=(e=1,a=10)=>b.get_clients_list({page:e,page_size:a});ze(()=>h.query,async e=>{const{page:a,pageSize:i}=e;r.page=Number(a)||r.page,r.pageSize=Number(i)||r.pageSize,A(r.page,r.pageSize).then(d=>{z.value=d.data.data.list,x.options.paginationConfig={total:d.data.data.total,currentPage:r.page,pageSize:r.pageSize,pageSizes:[10,50,100,1e3],layout:"total,prev, pager, next,sizes"}})},{immediate:!0});function H(){A(r.page,r.pageSize).then(e=>{z.value=e.data.data.list,x.options.paginationConfig={total:e.data.data.total,currentPage:r.page,pageSize:r.pageSize,pageSizes:[10,50,100,1e3],layout:"total,prev, pager, next,sizes"}})}xe(async()=>{const e=setInterval(H,2e3);Ne(()=>{clearInterval(e)})});const L=[{prop:"FirstStart",label:"FirstStart",showOverflowTooltip:!0,Color:"Color",width:"130"},{prop:"ExternalIP",label:"外网IP",showOverflowTooltip:!0,Color:"Color",width:"130"},{prop:"Username",label:"User",showOverflowTooltip:!0,width:"170",Color:"Color"},{prop:"Computer",label:"Computer",showOverflowTooltip:!0,width:"170",Color:"Color"},{prop:"Process",label:"Process",showOverflowTooltip:!0,Color:"Color"},{prop:"Pid",label:"Pid",showOverflowTooltip:!0,Color:"Color"},{prop:"Address",label:"Address",showOverflowTooltip:!0,Color:"Color",width:"200"},{prop:"Arch",label:"Arch",showOverflowTooltip:!0,width:"60",Color:"Color"},{prop:"Note",label:"Note",showOverflowTooltip:!0,Color:"Color",width:"120"},{prop:"Sleep",label:"Sleep",showOverflowTooltip:!0,width:"65",Color:"Color"},{label:"Online",slot:"onlineStatus",width:"80",align:"center",Color:"Color"},{label:"操作",buttons:[],slot:"action",Color:"Color"}],j=e=>{p.value=!0,f=e.Uid},G=async e=>{const{value:a}=await T.prompt("输入Note","Note",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"Note"});if(!a){m.warning("Note不能为空");return}(await b.add_uid_note({uid:e,note:a})).data.status===200&&m.success("Note成功"),p.value=!1},J=async e=>{const{value:a}=await T.prompt("Sleep",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"Sleep"});if(!a){m.warning("Sleep不能为空");return}(await b.edit_sleep({uid:e,sleep:a})).data.status===200&&m.success("修改Sleep成功"),p.value=!1},K=async e=>{g.value=!0},Z=e=>{T.confirm("是否退出客户端?","退出确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{(await b.do_exit({uid:e})).data.status===200&&m.success("退出成功"),p.value=!1})},Q=e=>{k.push({path:"/client/shell",query:{uid:e.Uid,user:e.Username,ip:e.ExternalIP,computer:e.Computer,arch:e.Arch,note:e.Note,address:e.Address,status:e.Online}})},x=Te({options:{showPagination:!0}}),{options:W}=Ae(x),P=Pe("reload"),X=async()=>{B.value="",await k.push({path:h.path,query:{page:1,pageSize:10,search:""}}),P()},Y=async(e,a)=>{await k.push({path:h.path,query:{page:e,pageSize:a}}),P()};return(e,a)=>{const i=ae,d=le,V=ne,y=ie,ee=ce,te=re,oe=de;return C(),S("div",Fe,[s(V,{modelValue:p.value,"onUpdate:modelValue":a[4]||(a[4]=t=>p.value=t),title:"客户端操作",width:"380px",class:"action-dialog","close-on-click-modal":!1},{default:o(()=>[l("div",$e,[s(d,{type:"primary",onClick:a[0]||(a[0]=t=>G(n(f))),class:"action-button"},{default:o(()=>[s(i,null,{default:o(()=>[s(n(ue))]),_:1}),c(" 添加备注 ")]),_:1}),s(d,{type:"success",onClick:a[1]||(a[1]=t=>K(n(f))),class:"action-button"},{default:o(()=>[s(i,null,{default:o(()=>[s(n(pe))]),_:1}),c(" 标记颜色 ")]),_:1}),s(d,{type:"warning",onClick:a[2]||(a[2]=t=>J(n(f))),class:"action-button"},{default:o(()=>[s(i,null,{default:o(()=>[s(n(_e))]),_:1}),c(" 设置休眠 ")]),_:1}),s(d,{type:"danger",onClick:a[3]||(a[3]=t=>Z(n(f))),class:"action-button"},{default:o(()=>[s(i,null,{default:o(()=>[s(n(fe))]),_:1}),c(" 退出客户端 ")]),_:1})])]),_:1},8,["modelValue"]),s(V,{modelValue:g.value,"onUpdate:modelValue":a[5]||(a[5]=t=>g.value=t),title:"选择标记颜色",width:"420px",onClose:D,"close-on-click-modal":!1,class:"color-dialog"},{footer:o(()=>[l("div",Le,[s(d,{onClick:M,class:"footer-button"},{default:o(()=>[c("取消")]),_:1}),s(d,{type:"primary",onClick:R,disabled:!_.value,class:"footer-button"},{default:o(()=>[c(" 确定 ")]),_:1},8,["disabled"])])]),default:o(()=>[l("div",qe,[De,l("div",Me,[(C(),S(Ve,null,Oe(U,(t,N)=>l("div",{key:N,class:E(["color-option",{"color-option-selected":_.value===t}]),onClick:pt=>_.value=t},[l("div",{class:"color-circle",style:O({backgroundColor:t})},null,4),l("span",He,u(t),1)],10,Re)),64))])])]),_:1},8,["modelValue"]),l("div",je,[s(oe,{shadow:"never",class:"table-card"},{header:o(()=>[l("div",Ge,[Je,l("div",Ke,[s(y,{type:"info",class:"refresh-tag"},{default:o(()=>[c(" 自动刷新: 2秒 ")]),_:1}),s(d,{type:"success",onClick:X,size:"small"},{default:o(()=>[s(i,null,{default:o(()=>[s(n(me))]),_:1}),c(" 手动刷新 ")]),_:1})])])]),default:o(()=>[s(we,{columns:L,"table-data":z.value,options:n(W),onPaginationChange:Y,class:"custom-table"},{FirstStart:o(({row:t})=>[l("div",Ze,[t.Color?(C(),S("div",{key:0,class:"color-indicator",style:O({backgroundColor:t.Color})},null,4)):Ee("",!0),l("span",Qe,u(F(t.FirstStart)),1)])]),ExternalIP:o(({row:t})=>[l("div",We,[s(i,{class:"ip-icon"},{default:o(()=>[s(n(he))]),_:1}),l("span",Xe,u(t.ExternalIP),1)])]),Username:o(({row:t})=>[l("div",Ye,[s(ee,{size:24,class:"user-avatar"},{default:o(()=>[c(u($(t.Username)),1)]),_:2},1024),l("span",et,u(t.Username),1)])]),Computer:o(({row:t})=>[l("div",tt,[s(i,{class:"computer-icon"},{default:o(()=>[s(n(ge))]),_:1}),l("span",ot,u(t.Computer),1)])]),Address:o(({row:t})=>[l("div",st,[s(y,{size:"small",type:"info",class:"address-tag"},{default:o(()=>[c(u(t.Address),1)]),_:2},1024)])]),Arch:o(({row:t})=>[s(y,{type:t.Arch==="x64"?"success":"warning",size:"small",class:"arch-tag"},{default:o(()=>[c(u(t.Arch),1)]),_:2},1032,["type"])]),Note:o(({row:t})=>[l("div",at,[t.Note?(C(),Ie(te,{key:0,content:t.Note||"暂无备注",placement:"top"},{default:o(()=>[l("span",lt,u(q(t.Note)),1)]),_:2},1032,["content"])):(C(),S("span",nt,"-"))])]),Sleep:o(({row:t})=>[l("div",it,[s(i,{class:"sleep-icon"},{default:o(()=>[s(n(ve))]),_:1}),l("span",ct,u(t.Sleep)+"s",1)])]),onlineStatus:o(({row:t})=>[l("div",rt,[l("div",{class:E(["status-dot",t.Online==="1"?"status-online":"status-offline"])},null,2),s(y,{type:t.Online==="1"?"success":"danger",size:"small",class:"status-tag"},{default:o(()=>[c(u(t.Online==="1"?"在线":"离线"),1)]),_:2},1032,["type"])])]),action:o(({row:t})=>[l("div",dt,[s(d,{type:"primary",onClick:N=>Q(t),size:"small",class:"action-btn"},{default:o(()=>[s(i,null,{default:o(()=>[s(n(Ce))]),_:1}),c(" 查看 ")]),_:2},1032,["onClick"]),s(d,{type:"info",onClick:N=>j(t),size:"small",class:"action-btn"},{default:o(()=>[s(i,null,{default:o(()=>[s(n(be))]),_:1}),c(" 更多 ")]),_:2},1032,["onClick"])])]),_:1},8,["table-data","options"])]),_:1})])])}}});const Nt=se(ut,[["__scopeId","data-v-64d9d316"]]);export{Nt as default};
